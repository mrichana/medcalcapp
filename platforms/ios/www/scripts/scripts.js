var app;!function(a){"use strict";angular.module("medical.services",["ngStorage","firebase"]).factory("uuid",function(){return{generate:function(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=(a+16*Math.random())%16|0;return a=Math.floor(a/16),("x"==b?c:7&c|8).toString(16)})}}}).factory("patientTemplateTest",function(){return function(a,b){var c=/^([0-9]+)#*/g,d=b&&b.amka&&0===b.amka.search(c)?b.amka.split(c)[1]:b.amka;return a&&a.firstname&&0===a.firstname.toLowerCase().lastIndexOf(b.firstname.toLowerCase(),0)&&a.lastname&&0===a.lastname.toLowerCase().lastIndexOf(b.lastname.toLowerCase(),0)&&a.amka&&0===a.amka.lastIndexOf(d,0)}}).factory("patientLocalStorage",["$q","$localStorage","uuid",function(a,b,c){b.patients=b.patients||{};var d=b.patients;return{patients:function(){var b=a.defer();return b.resolve({list:d,add:function(a){a.id=a.id||c.generate(),d[a.id]=a},remove:function(a){delete d[a.id]}}),b.promise},patient:function(b){var c=a.defer();return c.resolve({value:angular.copy(d[b]),save:function(){d[b]=this.value},"delete":function(){delete d[b]}}),c.promise}}}])}(app||(app={}));var controllers;!function(a){"use strict";var b=function(){function a(a,b){this.$scope=a,this.$location=b;var c=CalculatorViews.viewsCollection;a.filters=[{id:"All",name:"Όλοι",address:"/Calculators/All",category:"Υπολογιστές",content:_.reject(c.allList(),function(a){return"hidden"==a.category})},{id:"Generic",name:"Κλινική Ιατρική",address:"/Calculators/Generic",category:"Υπολογιστές",content:c.categories().generic},{id:"Pulmonology",name:"Πνευμονολογία",address:"/Calculators/Pulmonology",category:"Υπολογιστές",content:c.categories().pulmonology},{id:"Cardiology",name:"Καρδιολογία",address:"/Calculators/Cardiology",category:"Υπολογιστές",content:c.categories().cardiology},{id:"Ecg",name:"ΗΚΓ",address:"/Calculators/Ecg",category:"Υπολογιστές",content:c.categories().ecg},{id:"Triplex",name:"Triplex",address:"/Calculators/Triplex",category:"Υπολογιστές",content:c.categories().triplex},{id:"nstemi",name:"NSTEMI",address:"/Calculators/nstemi",category:"Κλινική",content:c.categories().nstemi},{id:"stemi",name:"STEMI",address:"/Calculators/stemi",category:"Κλινική",content:c.categories().stemi},{id:"af",name:"Κολπική Μαρμαρυγή",address:"/Calculators/af",category:"Κλινική",content:c.categories().af},{id:"hf",name:"Καρδιακή Ανεπάρκεια",address:"/Calculators/hf",category:"Κλινική",content:c.categories().hf}],a.setRelativeFilter=function(c){var d=_.findIndex(a.filters,function(b){return b.address==a.location});d+=c,d>=0&&d<a.filters.length&&b.path(a.filters[d].address)},a.$watch("location",function(){b.path(a.location)}),a.setAbsoluteFilter=function(b){a.activeFilterIndex=_.findIndex(a.filters,function(a){return a.id===b}),a.values={},a.views=_.map(a.filters[a.activeFilterIndex].content,function(b){return b.factory(a.values)}),a.panelsList=a.views},a.$on("$routeChangeSuccess",function(c,d){a.setAbsoluteFilter(d.params.id),a.location=b.path()}),a.clearPanel=function(b){var c=_.find(a.views,function(a){return a.id===b});c.reset()}}return a.$inject=["$scope","$location"],a}();a.calculatorCtrl=b}(controllers||(controllers={}));var filters;!function(a){"use strict";function b(a){return function(b){return a.trustAsHtml(angular.isDefined(b)?""+b:"")}}a.to_trusted=b,b.$inject=["$sce"]}(filters||(filters={}));var directives;!function(a){"use strict";function b(a){var b=$(a),c=b.closest(".scrollable-content"),d=c.scrollTop()+b.offset().top-c.offset().top;c.animate({scrollTop:d},{duration:1800})}function c(){return{restrict:"A",link:function(a,b,c){b.css("resize","none");var d=function(){b.height(0).height(b[0].scrollHeight)};b.on("change keyup keydown paste cut",function(){d()}),setTimeout(d,0)}}}function d(){return{link:function(a,c,d){c.bind("click",function(a){a.preventDefault(),d.href&&(d.scrollto=d.href);var c=$(d.scrollto);b(c)})}}}function e(){return{restrict:"A",link:function(a,b,c){var d;b.on("click",function(){if(d!==this){var a=this.value.search(c.selectOnFocus);"number"!==c.type?this.setSelectionRange(a,this.value.length):this.select(),d=this}}),b.on("blur",function(){d=null})}}}function f(){return{restrict:"E",replace:!0,scope:{view:"="},template:'<a class="list-group-item" scrollto="#{{view.id}}" scroll-spy="#{{view.id}}" href>{{view.name}} <i class="fa fa-chevron-right pull-right"></i></a>'}}function g(a,b){return{restrict:"A",link:function(c,d,e){var f=d,g=function(){var b=$(".scroll-item",f),c=f.height()/2;_.forEach(b,function(b,d,e){var g=$(b),h=g.offset().top-f.offset().top,i=h+g.height();c>h&&i>c&&(a.$broadcast("viewSelected",g),$("[scroll-spy]").removeClass("active"),$('[scroll-spy="#'+g.attr("id")+'"]').addClass("active"))})};f.on("scroll",g),b(g,1e3)}}}function h(){return{restrict:"A",link:function(a,b,c){a.$on("viewSelected",function(a,d){$("scroll-spy").removeClass("active"),b.toggleClass("active",d.is($(c.scrollSpy)))})}}}function i(a){return{restrict:"A",link:function(b,c,d){$(a).scroll(function(){var b,e,f,g=a.scrollY;g>c.offset().top&&(this.originalOffset=c.offset().top,b=$("body"),f=parseInt(b.css("padding-top"),10),e=parseInt(d.affixOffset,10),b.css("padding-top",f+e),c.addClass(d.affix||"affix")),g<this.originalOffset&&(b=$("body"),e=parseInt(d.affixOffset,10),f=parseInt(b.css("padding-top"),10),b.css("padding-top",f-e),c.removeClass(d.affix||"affix"))})}}}function j(){return{restrict:"E",replace:!0,scope:{result:"="},template:"<div ng-class=\"{'alert': result.resultlevel!=null, 'alert-danger': result.resultlevel==3, 'alert-warning': result.resultlevel==2, 'alert-info': result.resultlevel==1, 'alert-success': result.resultlevel==0}\"><h3 ng-bind-html=\"result.prefix + result.result + result.suffix | to_trusted\"></h3><h4 ng-bind-html=\"result.explanation | to_trusted\"></h4></div>"}}function k(a,b,c,d){return{restrict:"E",replace:!0,template:'<div class="text-center"><h3><i class="fa fa-spinner fa-spin"></i></h3></div>',scope:{view:"="},link:function(e,f,g){e.view.update&&(e.view.init&&e.view.init(),_.each(e.view.fields,function(a){"result"!=a.id&&e.$watch("view.values."+a.id,function(b,c,d){d.view.update&&(d.view.result=d.view.update(b,c,d,a))})}),_.each(e.view.external,function(a){e.$watch("view.values."+a,function(a,b,c){c.view.update&&(c.view.result=c.view.update(a,b,c,null))})}));var h,i=e.view.template||"calculator";d(function(){h=b.get("partials/views/"+i+".html",{cache:c}),h.success(function(a){f.html(a)}).then(function(){f.replaceWith(a(f.html())(e))})})}}}function l(){return{restrict:"E",require:"^ngModel",replace:!0,scope:{},template:'<div class="onoffswitch"><input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" checked><label class="onoffswitch-label"><span class="onoffswitch-inner" data-off="{{::off}}"" data-on="{{::on}}"></span><span class="onoffswitch-switch"></span></label></div>',link:function(a,b,c,d){a.on=c.on,a.off=c.off,d.$render=function(){$(b.children(0)[0]).prop("checked",d.$viewValue)},b.on("click tap",function(){c.disabled||(a.$apply(d.$setViewValue(!d.$viewValue)),d.$render())})}}}function m(a){var b={none:"",image:'<img ng-src="{{field.url}}" class="img-responsive"/>',number:'<input select-on-focus visible-on-focus class="form-control" type="number" step="{{field.input.step}}" min="{{field.input.min}}" max="{{field.input.max}}" ng-disabled="{{field.input.disabled}}" ng-class="{disabled: field.input.disabled}" name="{{field.id}}" ng-model="values[field.id]"/><span class="help-inline">{{field.description}}</span>',text:'<input select-on-focus visible-on-focus class="form-control" type="text" ng-disabled="{{field.input.disabled}}" ng-class="{disabled: field.input.disabled}" name="{{field.id}}" maxlength="{{field.input.length || 524288}}" ng-model="values[field.id]" /><span class="help-inline">{{field.description}}</span>',telephone:'<div class="input-group"><input select-on-focus visible-on-focus class="form-control" type="tel" ng-disabled="{{field.input.disabled}}" ng-class="{disabled: field.input.disabled}" name="{{field.id}}" maxlength="10" ng-model="values[field.id]" /><span class="input-group-btn"><a class="btn btn-default" href="tel:{{values[field.id]}}">Κλήση</a></span></div><span class="help-inline">{{field.description}}</span>',amka:'<input select-on-focus="#" visible-on-focus class="form-control" type="tel" ng-disabled="{{field.input.disabled}}" ng-class="{disabled: field.input.disabled}" name="{{field.id}}" maxlength="11" ng-model="values[field.id]" /><span class="help-inline">{{field.description}}</span>',select:'<select class="form-control" required ng-model="values[field.id]" ng-disabled="{{field.input.disabled}}" ng-class="{disabled: field.input.disabled}" ng-options="option.value as option.name for option in field.input.options"></select><span class="help-inline">{{fieldFromAnyValue(values[field.id], "value", field.input.options).description}}</span>',check:'<flipswitch ng-model="values[field.id]"></switch>',radio:'<div class="btn-group" data-toggle="buttons-checkbox"><button type="button" class="btn span2" ng-model="values[field.id]" ng-disabled="{{field.input.disabled}}" ng-class="{disabled: field.input.disabled}" ng-repeat="option in field.input.options" btn-radio="{{option.value}}">{{option.name}}</button></div><span class="help-block">{{fieldFromAnyValue(field.value, "value", field.input.options).description}}</span>',vradio:'<div class="btn-group btn-group-vertical" data-toggle="buttons-checkbox"><button type="button" class="btn span4" ng-model="values[field.id]" ng-disabled="{{field.input.disabled}}" ng-class="{disabled: field.input.disabled}" ng-repeat="option in field.input.options" btn-radio="{{option.value}}">{{option.name}}</button></div><span class="help-block">{{fieldFromAnyValue(field.value, "value", field.input.options).description}}</span>',result:'<result result="result"></result>',"static":'<div class="form-control-static" name="{{field.id}}" ng-bind-html="values[field.id] | to_trusted"></div>',staticmultiline:'<textarea class="form-control" ng-disabled="true" ng-class="{disabled: true}" name="{{field.id}}" ng-model="values[field.id]" />',date:'<input type="text" class="form-control" ng-model="values[field.id]" name="field.id" bs-datepicker data-date-type="date" data-date-format="dd-MM-yyyy" data-autoclose="true" data-max-date="today" data-icon-left="icon-left" data-icon-right="icon-right" data-use-native="true" data-start-view=2 />',multiline:'<textarea autosize visible-on-focus class="form-control" ng-disabled="{{field.input.disabled}}" ng-class="{disabled: field.input.disabled}" name="{{field.id}}" ng-model="values[field.id]" /><span class="help-inline">{{field.description}}</span>',richtext:'<textarea ui-tinymce="{language : \'el\', menubar : false, statusbar : false, resize: false, toolbar: [ \'undo redo paste | searchreplace | styleselect bold italic | alignleft aligncenter alignright | bullist numlist outdent indent | insertdatetime\'], insertdatetime_formats:[\'%d/%m/%Y\', \'%H:%M\', \'%d/%m/%Y %H:%M\'], plugins: \'autoresize paste insertdatetime lists searchreplace\'}" autosize visible-on-focus class="form-control" ng-disabled="{{field.input.disabled}}" ng-class="{disabled: field.input.disabled}" name="{{field.id}}" ng-model="values[field.id]" /><span class="help-inline">{{field.description}}</span>'};return{restrict:"E",replace:!0,scope:{field:"=",values:"=",result:"="},link:function(c,d,e){var f=b[c.field.input.type];d.html(f),d.replaceWith(a(f)(c))}}}function n(a,b){return{restrict:"A",scope:{verifiedClick:"&"},link:function(c,d,e){d.on("tap click",function(){c.$apply(function(){var f=e.verifyWait||1500;c.timer?(a.cancel(c.timer),c.timer=!1,b.removeClass(d,"verify"),c.verifiedClick(d,e)):(b.addClass(d,"verify"),c.timer=a(function(){c.timer=!1,b.removeClass(d,"verify")},f))})})}}}a.autosize=c,a.scrollto=d,a.selectOnFocus=e,a.navView=f,a.scrollMonitor=g,g.$inject=["$rootScope","$timeout"],a.scrollSpy=h,a.affix=i,i.$inject=["$window"],a.result=j,a.view=k,k.$inject=["$compile","$http","$templateCache","$timeout"],a.flipswitch=l,a.customInput=m,m.$inject=["$compile"],a.verifiedClick=n,n.$inject=["$timeout","$animate"]}(directives||(directives={}));var app;!function(a){"use strict";angular.module("medicalCalculator",["medical.services","ngRoute","ngTouch","ngAnimate","ngSanitize","mobile-angular-ui","mgcrea.ngStrap","firebase"]).filter("to_trusted",filters.to_trusted).controller("calculatorCtrl",controllers.calculatorCtrl).directive("autosize",directives.autosize).directive("scrollto",directives.scrollto).directive("selectOnFocus",directives.selectOnFocus).directive("navView",directives.navView).directive("scrollMonitor",directives.scrollMonitor).directive("affix",directives.affix).directive("scrollSpy",directives.scrollSpy).directive("result",directives.result).directive("view",directives.view).directive("flipswitch",directives.flipswitch).directive("customInput",directives.customInput).directive("verifiedClick",directives.verifiedClick).config(["$routeProvider","$locationProvider",function(a,b){a.when("/Calculators/:id",{templateUrl:"partials/calculators.html",controller:"calculatorCtrl"}).when("/Patient/:id",{templateUrl:"partials/patient.html",controller:"patientCtrl",resolve:{patient:["$route","patientHybridStorage",function(a,b){return b.patient(a.current.params.id)}]}}).when("/Patients",{templateUrl:"partials/patients.html",controller:"patientsCtrl",resolve:{patients:["patientHybridStorage",function(a){return a.patients()}]}}).otherwise({redirectTo:"/Calculators/Generic"}),b.html5Mode(!1)}])}(app||(app={}));